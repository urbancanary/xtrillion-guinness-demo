# Google Analysis 10 - Production Environment (LOCKED for External Users)
# This configuration is LOCKED and should only change for critical hotfixes

runtime: python311

# Production service name
service: default

# Standard entrypoint for Flask app
entrypoint: gunicorn --bind :$PORT --workers 2 --threads 4 --timeout 60 google_analysis10_api:app

env_variables:
  PORT: 8080
  ENVIRONMENT: production
  DATABASE_SOURCE: gcs
  PYTHONPATH: /srv
  VERSION: "v10.0.0"
  API_VERSION: "v1"
  EXTERNAL_USERS: "true"

# Production scaling - optimized for external users
automatic_scaling:
  min_instances: 1  # Always ready for external users
  max_instances: 10
  target_cpu_utilization: 0.6

# High-performance resources for production
resources:
  cpu: 2
  memory_gb: 8

# Strict health checks for production
readiness_check:
  path: "/health"
  check_interval_sec: 5
  timeout_sec: 4
  failure_threshold: 2
  success_threshold: 2

liveness_check:
  path: "/health"
  check_interval_sec: 30
  timeout_sec: 4
  failure_threshold: 3
  success_threshold: 2

# Skip files that could cause issues
skip_files:
- ^(.*/)?#.*#$
- ^(.*/)?.*~$
- ^(.*/)?.*\.py[co]$
- ^(.*/)?.*/RCS/.*$
- ^(.*/)?\..*$
- ^(.*/)?.*\.bak$
- ^(.*/)?test_.*\.py$
- ^(.*/)?debug_.*\.py$
- ^(.*/)?archive/.*$
- ^(.*/)?backups_.*$
